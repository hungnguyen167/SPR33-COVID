dpm_stage2 <- filter(covid, covid$date > "2020-03-19" & covid$date <= "2020-04-07")
dpm_stage2 <- round(aggregate(dpm_stage2[,-2], by = list(dpm_stage2$cow), FUN = mean, na.rm = TRUE),4)
dpm_stage2$dpm2 <- ifelse(is.nan(dpm_stage2$dpm), 0, dpm_stage2$dpm)
dpm_stage2 <- select(dpm_stage2, cow, dpm2)
gov_resp1 <- gov_resp %>%
mutate(
date = as.Date(as.character(Date), "%Y%m%d"),
chi = ContainmentHealthIndex/20,
cow = countrycode(CountryName, origin = "country.name", destination = "cown")
) %>%
filter(date >= "2020-03-01" & date <= "2020-03-15" & cow %in% issp16dfa$cow) %>%
select(CountryName, date, chi)
gov_resp1 <- aggregate(x = gov_resp1[,-2], by = list(gov_resp1$CountryName), FUN = mean)
gov_resp1 <- gov_resp1 %>%
mutate(
cname = Group.1,
cow = countrycode(cname, origin = "country.name", destination = "cown"),
chi1 = round(scale(chi),2),
chi1.2 = round(chi,2)
) %>%
select(cow, chi1, chi1.2) %>%
arrange(cow)
## Public Reaction Stage: March 20th to April 7th
gov_resp2 <- gov_resp %>%
mutate(
date = as.Date(as.character(Date), "%Y%m%d"),
chi = ContainmentHealthIndex/20,
cow = countrycode(CountryName, origin = "country.name", destination = "cown")
) %>%
filter(date > "2020-03-19" & date <= "2020-04-07" & cow %in% issp16dfa$cow) %>%
select(CountryName, date, chi)
gov_resp2 <- aggregate(x = gov_resp2[,-2], by = list(gov_resp2$CountryName), FUN = mean)
gov_resp2 <- gov_resp2 %>%
mutate(
cname = Group.1,
cow = countrycode(cname, origin = "country.name", destination = "cown"),
chi2 = round(scale(chi),2),
chi2.2 = round(chi,2)
) %>%
select(cow, chi2, chi2.2) %>%
arrange(cow)
df <- left_join(issp16dfa, gov_resp1, by = "cow")
df <- left_join(df, gov_resp2, by = "cow")
df <- left_join(df, gov_resp3, by = "cow")
df <- left_join(df, betrack_av, by = "cow")
df <- left_join(df, dpm_stage1, by = "cow")
df <- left_join(df, dpm_stage2, by = "cow")
df <- left_join(df, dpm_stage3, by = "cow")
df <- left_join(df, gini_disp, by = "cow")
df <- left_join(df, gdp, by = "cow")
df <- left_join(df, socp, by = "cow")
## filter out Suriname
df <- df[-which(df$cow==115),]
m11 <- lm(chi1 ~ dpm1 + gov_author , data = df)
m12 <- lm(chi1 ~ dpm1 + gov_author + gini_disp, data = df)
m13 <- lm(chi1 ~ dpm1 + gov_author + soc_spend, data = df)
m14 <- lm(chi1 ~ dpm1 + gov_author + gdp, data = df)
m15 <- lm(chi1 ~ dpm1 + gov_author + gini_disp + soc_spend + gdp, data = df)
tab_model(m11, m12, m13, m14, m15, p.style = "stars", p.threshold = c(0.10, 0.05, 0.01), show.ci = F,  dv.labels = c("M11", "M12","M13", "M14","M15"), pred.labels = c("Intercept", "Deaths per Million", "Public Preferences", "Disposable Income Inequality", "Social Spending", "GDP (k$, per capita)"))
df$chi1_p <- predict.lm(m11, newdata = df)
df$gap1 <- round(df$chi1 - df$chi1_p,3)
df$gap1_cat <- as.factor(ifelse(df$gap1 > 0, 1, 0))
m21 <- lm(behave ~ dpm2 + chi2 , data = df)
m22 <- lm(behave  ~ dpm2 + chi2 + gap1, data = df)
m23 <- lm(behave  ~ dpm2 +  chi2 + gap1  + gini_disp, data = df)
m24 <- lm(behave ~ dpm2 +  chi2 + gap1  + soc_spend, data = df)
m25 <- lm(behave ~ dpm2 + chi2 + gap1 + gdp, data = df)
m26 <- lm(behave ~ dpm2 + chi2 + gap1 + gini_disp + soc_spend + gdp, data = df)
tab_model(m21, m22, m23, m24, m25, m26, p.style = "stars", p.threshold = c(0.10, 0.05, 0.01), show.ci = F,  dv.labels = c("M21", "M22","M23", "M24","M25", "M26"), pred.labels = c("Intercept", "Deaths per Million", "Current Gov. Intervention", "Discrepancy from Outbreak Stage",  "Disposable Income Inequality", "Social Spending", "GDP (k$, per capita)"))
m31 <- lm(behave ~ dpm2 + chi2 , data = df)
m32 <- lm(behave  ~ dpm2 + chi2 + gap1_cat, data = df)
m33 <- lm(behave  ~ dpm2 +  chi2 + gap1_cat  + gini_disp, data = df)
m34 <- lm(behave ~ dpm2 +  chi2 + gap1_cat  + soc_spend, data = df)
m35 <- lm(behave ~ dpm2 + chi2 + gap1_cat + gdp, data = df)
m36 <- lm(behave ~ dpm2 + chi2 + gap1_cat + gini_disp + soc_spend + gdp, data = df)
tab_model(m31, m32, m33, m34, m35, m36, p.style = "stars", p.threshold = c(0.10, 0.05, 0.01), show.ci = F,  dv.labels = c("M31", "M32","M33", "M34","M35", "M36"), pred.labels = c("Intercept", "Deaths per Million", "Current Gov. Intervention", "Positive Discrepancy from Outbreak Stage",  "Disposable Income Inequality", "Social Spending", "GDP (k$, per capita)"))
m21 <- lm(behave ~ dpm2 + chi2 , data = df)
m22 <- lm(behave  ~ dpm2 + chi2 + gap1, data = df)
m23 <- lm(behave  ~ dpm2 +  chi2 + gap1  + gini_disp, data = df)
m24 <- lm(behave ~ dpm2 +  chi2 + gap1  + soc_spend, data = df)
m25 <- lm(behave ~ dpm2 + chi2 + gap1 + gdp, data = df)
m26 <- lm(behave ~ dpm2 + chi2 + gap1 + gini_disp + soc_spend + gdp, data = df)
tab_model(m21, m22, m23, m24, m25, m26, p.style = "stars", p.threshold = c(0.10, 0.05, 0.01), show.ci = F,  dv.labels = c("M21", "M22","M23", "M24","M25", "M26"), pred.labels = c("Intercept", "Deaths per Million", "Current Gov. Intervention", "Discrepancy from Outbreak Stage",  "Disposable Income Inequality", "Social Spending", "GDP (k$, per capita)"))
tab_model(m11, m12, m13, m14, m15, p.style = "stars", p.threshold = c(0.10, 0.05, 0.01), show.ci = F,  dv.labels = c("M11", "M12","M13", "M14","M15"), pred.labels = c("Intercept", "Deaths per Million", "Public Preferences", "Disposable Income Inequality", "Social Spending", "GDP (k$, per capita)"))
View(df)
covid[which(covid$cow == 101),]
View(covid)
dpm_stage1$dpm1 <- ifelse(is.na(dpm_stage1$dpm1), 0, dpm_stage1$dpm1)
df <- left_join(issp16dfa, gov_resp1, by = "cow")
df <- left_join(df, gov_resp2, by = "cow")
df <- left_join(df, gov_resp3, by = "cow")
df <- left_join(df, betrack_av, by = "cow")
df <- left_join(df, dpm_stage1, by = "cow")
df <- left_join(df, dpm_stage2, by = "cow")
df <- left_join(df, dpm_stage3, by = "cow")
df <- left_join(df, gini_disp, by = "cow")
df <- left_join(df, gdp, by = "cow")
df <- left_join(df, socp, by = "cow")
## filter out Suriname
df <- df[-which(df$cow==115),]
m11 <- lm(chi1 ~ dpm1 + gov_author , data = df)
m12 <- lm(chi1 ~ dpm1 + gov_author + gini_disp, data = df)
m13 <- lm(chi1 ~ dpm1 + gov_author + soc_spend, data = df)
m14 <- lm(chi1 ~ dpm1 + gov_author + gdp, data = df)
m15 <- lm(chi1 ~ dpm1 + gov_author + gini_disp + soc_spend + gdp, data = df)
tab_model(m11, m12, m13, m14, m15, p.style = "stars", p.threshold = c(0.10, 0.05, 0.01), show.ci = F,  dv.labels = c("M11", "M12","M13", "M14","M15"), pred.labels = c("Intercept", "Deaths per Million", "Public Preferences", "Disposable Income Inequality", "Social Spending", "GDP (k$, per capita)"))
df$chi1_p <- predict.lm(m11, newdata = df)
df$gap1 <- round(df$chi1 - df$chi1_p,3)
df$gap1_cat <- as.factor(ifelse(df$gap1 > 0, 1, 0))
View(df)
View(dpm_stage1)
dpm_stage1[(length(dpm_stage1$cow) + 1), 1] <- 101
dpm_stage1[(length(dpm_stage1$cow) + 1), 1] <- 640
dpm_stage1$dpm1[dpm_stage1$cow == 101] <- 0
dpm_stage1$dpm1[dpm_stage1$cow == 640] <- 0
df <- left_join(issp16dfa, gov_resp1, by = "cow")
df <- left_join(df, gov_resp2, by = "cow")
df <- left_join(df, gov_resp3, by = "cow")
df <- left_join(df, betrack_av, by = "cow")
df <- left_join(df, dpm_stage1, by = "cow")
df <- left_join(df, dpm_stage2, by = "cow")
df <- left_join(df, dpm_stage3, by = "cow")
df <- left_join(df, gini_disp, by = "cow")
df <- left_join(df, gdp, by = "cow")
df <- left_join(df, socp, by = "cow")
## filter out Suriname
df <- df[-which(df$cow==115),]
m11 <- lm(chi1 ~ dpm1 + gov_author , data = df)
m12 <- lm(chi1 ~ dpm1 + gov_author + gini_disp, data = df)
m13 <- lm(chi1 ~ dpm1 + gov_author + soc_spend, data = df)
m14 <- lm(chi1 ~ dpm1 + gov_author + gdp, data = df)
m15 <- lm(chi1 ~ dpm1 + gov_author + gini_disp + soc_spend + gdp, data = df)
tab_model(m11, m12, m13, m14, m15, p.style = "stars", p.threshold = c(0.10, 0.05, 0.01), show.ci = F,  dv.labels = c("M11", "M12","M13", "M14","M15"), pred.labels = c("Intercept", "Deaths per Million", "Public Preferences", "Disposable Income Inequality", "Social Spending", "GDP (k$, per capita)"))
df$chi1_p <- predict.lm(m11, newdata = df)
df$gap1 <- round(df$chi1 - df$chi1_p,3)
df$gap1_cat <- as.factor(ifelse(df$gap1 > 0, 1, 0))
m21 <- lm(behave ~ dpm2 + chi2 , data = df)
m22 <- lm(behave  ~ dpm2 + chi2 + gap1, data = df)
m23 <- lm(behave  ~ dpm2 +  chi2 + gap1  + gini_disp, data = df)
m24 <- lm(behave ~ dpm2 +  chi2 + gap1  + soc_spend, data = df)
m25 <- lm(behave ~ dpm2 + chi2 + gap1 + gdp, data = df)
m26 <- lm(behave ~ dpm2 + chi2 + gap1 + gini_disp + soc_spend + gdp, data = df)
tab_model(m21, m22, m23, m24, m25, m26, p.style = "stars", p.threshold = c(0.10, 0.05, 0.01), show.ci = F,  dv.labels = c("M21", "M22","M23", "M24","M25", "M26"), pred.labels = c("Intercept", "Deaths per Million", "Current Gov. Intervention", "Discrepancy from Outbreak Stage",  "Disposable Income Inequality", "Social Spending", "GDP (k$, per capita)"))
m31 <- lm(behave ~ dpm2 + chi2 , data = df)
m32 <- lm(behave  ~ dpm2 + chi2 + gap1_cat, data = df)
m33 <- lm(behave  ~ dpm2 +  chi2 + gap1_cat  + gini_disp, data = df)
m34 <- lm(behave ~ dpm2 +  chi2 + gap1_cat  + soc_spend, data = df)
m35 <- lm(behave ~ dpm2 + chi2 + gap1_cat + gdp, data = df)
m36 <- lm(behave ~ dpm2 + chi2 + gap1_cat + gini_disp + soc_spend + gdp, data = df)
tab_model(m31, m32, m33, m34, m35, m36, p.style = "stars", p.threshold = c(0.10, 0.05, 0.01), show.ci = F,  dv.labels = c("M31", "M32","M33", "M34","M35", "M36"), pred.labels = c("Intercept", "Deaths per Million", "Current Gov. Intervention", "Positive Discrepancy from Outbreak Stage",  "Disposable Income Inequality", "Social Spending", "GDP (k$, per capita)"))
betrack_complete <- betrack[complete.cases(betrack),]
betrack_complete <- betrack_complete[which(betrack_complete$cow %in% issp16df$cow),]
betrack_complete <- betrack_complete[-which(betrack_complete$cow == 115),]
betrack_complete$behave <- round((betrack_complete$stay + 0.776*betrack_complete$gather + 1.083*betrack_complete$distance)/3,2)
## Take the Country-Average
betrack_av <- round(aggregate(betrack_complete[,-2], by = list(betrack_complete$cow), FUN = mean, na.rm = T),2)
## Now create a standardized score at the country level
betrack_av <- betrack_av %>%
mutate(
behave = scale(behave)
) %>%
filter(cow %in% issp16dfa$cow) %>%
select(cow, behave)
dpm_stage2 <- filter(covid, covid$date >= "2020-03-15" & covid$date <= "2020-04-03")
dpm_stage2 <- round(aggregate(dpm_stage2[,-2], by = list(dpm_stage2$cow), FUN = mean, na.rm = TRUE),4)
dpm_stage2$dpm2 <- ifelse(is.nan(dpm_stage2$dpm), 0, dpm_stage2$dpm)
dpm_stage2 <- select(dpm_stage2, cow, dpm2)
df <- left_join(issp16dfa, gov_resp1, by = "cow")
df <- left_join(df, gov_resp2, by = "cow")
df <- left_join(df, gov_resp3, by = "cow")
df <- left_join(df, betrack_av, by = "cow")
df <- left_join(df, dpm_stage1, by = "cow")
df <- left_join(df, dpm_stage2, by = "cow")
df <- left_join(df, dpm_stage3, by = "cow")
df <- left_join(df, gini_disp, by = "cow")
df <- left_join(df, gdp, by = "cow")
df <- left_join(df, socp, by = "cow")
## filter out Suriname
df <- df[-which(df$cow==115),]
m11 <- lm(chi1 ~ dpm1 + gov_author , data = df)
m12 <- lm(chi1 ~ dpm1 + gov_author + gini_disp, data = df)
m13 <- lm(chi1 ~ dpm1 + gov_author + soc_spend, data = df)
m14 <- lm(chi1 ~ dpm1 + gov_author + gdp, data = df)
m15 <- lm(chi1 ~ dpm1 + gov_author + gini_disp + soc_spend + gdp, data = df)
tab_model(m11, m12, m13, m14, m15, p.style = "stars", p.threshold = c(0.10, 0.05, 0.01), show.ci = F,  dv.labels = c("M11", "M12","M13", "M14","M15"), pred.labels = c("Intercept", "Deaths per Million", "Public Preferences", "Disposable Income Inequality", "Social Spending", "GDP (k$, per capita)"))
df$chi1_p <- predict.lm(m11, newdata = df)
df$gap1 <- round(df$chi1 - df$chi1_p,3)
df$gap1_cat <- as.factor(ifelse(df$gap1 > 0, 1, 0))
m21 <- lm(behave ~ dpm2 + chi2 , data = df)
m22 <- lm(behave  ~ dpm2 + chi2 + gap1, data = df)
m23 <- lm(behave  ~ dpm2 +  chi2 + gap1  + gini_disp, data = df)
m24 <- lm(behave ~ dpm2 +  chi2 + gap1  + soc_spend, data = df)
m25 <- lm(behave ~ dpm2 + chi2 + gap1 + gdp, data = df)
m26 <- lm(behave ~ dpm2 + chi2 + gap1 + gini_disp + soc_spend + gdp, data = df)
tab_model(m21, m22, m23, m24, m25, m26, p.style = "stars", p.threshold = c(0.10, 0.05, 0.01), show.ci = F,  dv.labels = c("M21", "M22","M23", "M24","M25", "M26"), pred.labels = c("Intercept", "Deaths per Million", "Current Gov. Intervention", "Discrepancy from Outbreak Stage",  "Disposable Income Inequality", "Social Spending", "GDP (k$, per capita)"))
betrack <- read_dta(wdir("data/GlobalBehaviorsPerceptions_Data_May21_2020.dta"))
betrack_complete <- betrack[complete.cases(betrack),]
betrack_complete <- betrack_complete[which(betrack_complete$cow %in% issp16df$cow),]
betrack_complete <- betrack_complete[-which(betrack_complete$cow == 115),]
betrack <- betrack %>%
mutate(
cow = countrycode(iso2c, origin = "iso2c", destination = "cown"),
stay = scale(beh_stayhome),
gather = scale(beh_socgathering),
distance = scale(beh_distance),
tsymp = scale(beh_tellsymp),
hwash = scale(beh_handwash)
) %>%
select(cow, date, stay, gather, distance, tsymp, hwash)
betrack_complete <- betrack[complete.cases(betrack),]
betrack_complete <- betrack_complete[which(betrack_complete$cow %in% issp16df$cow),]
betrack_complete <- betrack_complete[-which(betrack_complete$cow == 115),]
betrack_complete$behave <- round((betrack_complete$stay + 0.776*betrack_complete$gather + 1.083*betrack_complete$distance)/3,2)
## Take the Country-Average
betrack_av <- round(aggregate(betrack_complete[,-2], by = list(betrack_complete$cow), FUN = mean, na.rm = T),2)
## Now create a standardized score at the country level
betrack_av <- betrack_av %>%
mutate(
behave = scale(behave)
) %>%
filter(cow %in% issp16dfa$cow) %>%
select(cow, behave)
dpm_stage2 <- filter(covid, covid$date >= "2020-03-15" & covid$date <= "2020-04-02")
dpm_stage2 <- round(aggregate(dpm_stage2[,-2], by = list(dpm_stage2$cow), FUN = mean, na.rm = TRUE),4)
dpm_stage2$dpm2 <- ifelse(is.nan(dpm_stage2$dpm), 0, dpm_stage2$dpm)
dpm_stage2 <- select(dpm_stage2, cow, dpm2)
gov_resp1 <- gov_resp %>%
mutate(
date = as.Date(as.character(Date), "%Y%m%d"),
chi = ContainmentHealthIndex/20,
cow = countrycode(CountryName, origin = "country.name", destination = "cown")
) %>%
filter(date >= "2020-03-01" & date <= "2020-03-15" & cow %in% issp16dfa$cow) %>%
select(CountryName, date, chi)
gov_resp1 <- aggregate(x = gov_resp1[,-2], by = list(gov_resp1$CountryName), FUN = mean)
gov_resp1 <- gov_resp1 %>%
mutate(
cname = Group.1,
cow = countrycode(cname, origin = "country.name", destination = "cown"),
chi1 = round(scale(chi),2),
chi1.2 = round(chi,2)
) %>%
select(cow, chi1, chi1.2) %>%
arrange(cow)
## Public Reaction Stage: March 20th to April 7th
gov_resp2 <- gov_resp %>%
mutate(
date = as.Date(as.character(Date), "%Y%m%d"),
chi = ContainmentHealthIndex/20,
cow = countrycode(CountryName, origin = "country.name", destination = "cown")
) %>%
filter(date > "2020-03-19" & date <= "2020-04-07" & cow %in% issp16dfa$cow) %>%
select(CountryName, date, chi)
gov_resp2 <- aggregate(x = gov_resp2[,-2], by = list(gov_resp2$CountryName), FUN = mean)
gov_resp2 <- gov_resp2 %>%
mutate(
cname = Group.1,
cow = countrycode(cname, origin = "country.name", destination = "cown"),
chi2 = round(scale(chi),2),
chi2.2 = round(chi,2)
) %>%
select(cow, chi2, chi2.2) %>%
arrange(cow)
df <- left_join(issp16dfa, gov_resp1, by = "cow")
df <- left_join(df, gov_resp2, by = "cow")
df <- left_join(df, gov_resp3, by = "cow")
df <- left_join(df, betrack_av, by = "cow")
df <- left_join(df, dpm_stage1, by = "cow")
df <- left_join(df, dpm_stage2, by = "cow")
df <- left_join(df, dpm_stage3, by = "cow")
df <- left_join(df, gini_disp, by = "cow")
df <- left_join(df, gdp, by = "cow")
df <- left_join(df, socp, by = "cow")
## filter out Suriname
df <- df[-which(df$cow==115),]
m11 <- lm(chi1 ~ dpm1 + gov_author , data = df)
m12 <- lm(chi1 ~ dpm1 + gov_author + gini_disp, data = df)
m13 <- lm(chi1 ~ dpm1 + gov_author + soc_spend, data = df)
m14 <- lm(chi1 ~ dpm1 + gov_author + gdp, data = df)
m15 <- lm(chi1 ~ dpm1 + gov_author + gini_disp + soc_spend + gdp, data = df)
tab_model(m11, m12, m13, m14, m15, p.style = "stars", p.threshold = c(0.10, 0.05, 0.01), show.ci = F,  dv.labels = c("M11", "M12","M13", "M14","M15"), pred.labels = c("Intercept", "Deaths per Million", "Public Preferences", "Disposable Income Inequality", "Social Spending", "GDP (k$, per capita)"))
df$chi1_p <- predict.lm(m11, newdata = df)
df$gap1 <- round(df$chi1 - df$chi1_p,3)
df$gap1_cat <- as.factor(ifelse(df$gap1 > 0, 1, 0))
m21 <- lm(behave ~ dpm2 + chi2 , data = df)
m22 <- lm(behave  ~ dpm2 + chi2 + gap1, data = df)
m23 <- lm(behave  ~ dpm2 +  chi2 + gap1  + gini_disp, data = df)
m24 <- lm(behave ~ dpm2 +  chi2 + gap1  + soc_spend, data = df)
m25 <- lm(behave ~ dpm2 + chi2 + gap1 + gdp, data = df)
m26 <- lm(behave ~ dpm2 + chi2 + gap1 + gini_disp + soc_spend + gdp, data = df)
tab_model(m21, m22, m23, m24, m25, m26, p.style = "stars", p.threshold = c(0.10, 0.05, 0.01), show.ci = F,  dv.labels = c("M21", "M22","M23", "M24","M25", "M26"), pred.labels = c("Intercept", "Deaths per Million", "Current Gov. Intervention", "Discrepancy from Outbreak Stage",  "Disposable Income Inequality", "Social Spending", "GDP (k$, per capita)"))
m31 <- lm(behave ~ dpm2 + chi2 , data = df)
m32 <- lm(behave  ~ dpm2 + chi2 + gap1_cat, data = df)
m33 <- lm(behave  ~ dpm2 +  chi2 + gap1_cat  + gini_disp, data = df)
m34 <- lm(behave ~ dpm2 +  chi2 + gap1_cat  + soc_spend, data = df)
m35 <- lm(behave ~ dpm2 + chi2 + gap1_cat + gdp, data = df)
m36 <- lm(behave ~ dpm2 + chi2 + gap1_cat + gini_disp + soc_spend + gdp, data = df)
tab_model(m31, m32, m33, m34, m35, m36, p.style = "stars", p.threshold = c(0.10, 0.05, 0.01), show.ci = F,  dv.labels = c("M31", "M32","M33", "M34","M35", "M36"), pred.labels = c("Intercept", "Deaths per Million", "Current Gov. Intervention", "Positive Discrepancy from Outbreak Stage",  "Disposable Income Inequality", "Social Spending", "GDP (k$, per capita)"))
unique(df$gap1_cat)
unique(df$gap1)
dpm_stage1 <- filter(covid, covid$date >= "2020-03-01" & covid$date <= "2020-03-10")
dpm_stage1 <- round(aggregate(dpm_stage1[,-2], by = list(dpm_stage1$cow), FUN = mean, na.rm = TRUE),4)
dpm_stage1$dpm1 <- ifelse(is.nan(dpm_stage1$dpm), 0, dpm_stage1$dpm)
dpm_stage1 <- select(dpm_stage1, cow, dpm1)
## Public Reaction Stage (20/03 - 07/04)
dpm_stage2 <- filter(covid, covid$date >= "2020-03-20" & covid$date <= "2020-04-07")
dpm_stage2 <- round(aggregate(dpm_stage2[,-2], by = list(dpm_stage2$cow), FUN = mean, na.rm = TRUE),4)
dpm_stage2$dpm2 <- ifelse(is.nan(dpm_stage2$dpm), 0, dpm_stage2$dpm)
dpm_stage2 <- select(dpm_stage2, cow, dpm2)
## Sensitivity Analysis - Outbreak Stage: March 1st to March 19th
dpm_stage3 <- filter(covid, covid$date >= "2020-03-01" & covid$date <= "2020-03-19")
dpm_stage3 <- round(aggregate(dpm_stage3[,-2], by = list(dpm_stage3$cow), FUN = mean, na.rm = TRUE),4)
dpm_stage3$dpm3 <- ifelse(is.nan(dpm_stage3$dpm), 0, dpm_stage3$dpm)
dpm_stage3 <- select(dpm_stage3, cow, dpm3)
## Outbreak Stage: March 1st to March 15th
gov_resp1 <- gov_resp %>%
mutate(
date = as.Date(as.character(Date), "%Y%m%d"),
chi = ContainmentHealthIndex/20,
cow = countrycode(CountryName, origin = "country.name", destination = "cown")
) %>%
filter(date >= "2020-03-01" & date <= "2020-03-15" & cow %in% issp16dfa$cow) %>%
select(CountryName, date, chi)
gov_resp1 <- aggregate(x = gov_resp1[,-2], by = list(gov_resp1$CountryName), FUN = mean)
gov_resp1 <- gov_resp1 %>%
mutate(
cname = Group.1,
cow = countrycode(cname, origin = "country.name", destination = "cown"),
chi1 = round(scale(chi),2),
chi1.2 = round(chi,2)
) %>%
select(cow, chi1, chi1.2) %>%
arrange(cow)
## Public Reaction Stage: March 20th to April 7th
gov_resp2 <- gov_resp %>%
mutate(
date = as.Date(as.character(Date), "%Y%m%d"),
chi = ContainmentHealthIndex/20,
cow = countrycode(CountryName, origin = "country.name", destination = "cown")
) %>%
filter(date >= "2020-03-20" & date <= "2020-04-07" & cow %in% issp16dfa$cow) %>%
select(CountryName, date, chi)
gov_resp2 <- aggregate(x = gov_resp2[,-2], by = list(gov_resp2$CountryName), FUN = mean)
gov_resp2 <- gov_resp2 %>%
mutate(
cname = Group.1,
cow = countrycode(cname, origin = "country.name", destination = "cown"),
chi2 = round(scale(chi),2),
chi2.2 = round(chi,2)
) %>%
select(cow, chi2, chi2.2) %>%
arrange(cow)
## Sensitivity Analysis - Reaction Stage: March 1st to March 19th
gov_resp3 <- gov_resp %>%
mutate(
date = as.Date(as.character(Date), "%Y%m%d"),
chi = ContainmentHealthIndex/20,
cow = countrycode(CountryName, origin = "country.name", destination = "cown")
) %>%
filter(date >= "2020-03-01" & date <= "2020-03-19" & cow %in% issp16dfa$cow) %>%
select(CountryName, date, chi)
gov_resp3 <- aggregate(x = gov_resp3[,-2], by = list(gov_resp3$CountryName), FUN = mean)
gov_resp3 <- gov_resp3 %>%
mutate(
cname = Group.1,
cow = countrycode(cname, origin = "country.name", destination = "cown"),
chi3 = round(scale(chi),2),
) %>%
select(cow, chi3) %>%
arrange(cow)
df <- left_join(issp16dfa, gov_resp1, by = "cow")
df <- left_join(df, gov_resp2, by = "cow")
df <- left_join(df, gov_resp3, by = "cow")
df <- left_join(df, betrack_av, by = "cow")
df <- left_join(df, dpm_stage1, by = "cow")
df <- left_join(df, dpm_stage2, by = "cow")
df <- left_join(df, dpm_stage3, by = "cow")
df <- left_join(df, gini_disp, by = "cow")
df <- left_join(df, gdp, by = "cow")
df <- left_join(df, socp, by = "cow")
## filter out Suriname
df <- df[-which(df$cow==115),]
m11 <- lm(chi1 ~ dpm1 + gov_author , data = df)
m12 <- lm(chi1 ~ dpm1 + gov_author + gini_disp, data = df)
m13 <- lm(chi1 ~ dpm1 + gov_author + soc_spend, data = df)
m14 <- lm(chi1 ~ dpm1 + gov_author + gdp, data = df)
m15 <- lm(chi1 ~ dpm1 + gov_author + gini_disp + soc_spend + gdp, data = df)
tab_model(m11, m12, m13, m14, m15, p.style = "stars", p.threshold = c(0.10, 0.05, 0.01), show.ci = F,  dv.labels = c("M11", "M12","M13", "M14","M15"), pred.labels = c("Intercept", "Deaths per Million", "Public Preferences", "Disposable Income Inequality", "Social Spending", "GDP (k$, per capita)"))
df$chi1_p <- predict.lm(m11, newdata = df)
df$gap1 <- round(df$chi1 - df$chi1_p,3)
df$gap1_cat <- as.factor(ifelse(df$gap1 > 0, 1, 0))
gov_resp1 <- gov_resp %>%
mutate(
date = as.Date(as.character(Date), "%Y%m%d"),
chi = ContainmentHealthIndex/20,
cow = countrycode(CountryName, origin = "country.name", destination = "cown")
) %>%
filter(date >= "2020-03-01" & date <= "2020-03-13" & cow %in% issp16dfa$cow) %>%
select(CountryName, date, chi)
gov_resp1 <- aggregate(x = gov_resp1[,-2], by = list(gov_resp1$CountryName), FUN = mean)
gov_resp1 <- gov_resp1 %>%
mutate(
cname = Group.1,
cow = countrycode(cname, origin = "country.name", destination = "cown"),
chi1 = round(scale(chi),2),
chi1.2 = round(chi,2)
) %>%
select(cow, chi1, chi1.2) %>%
arrange(cow)
dpm_stage1 <- filter(covid, covid$date >= "2020-03-01" & covid$date <= "2020-03-13")
dpm_stage1 <- round(aggregate(dpm_stage1[,-2], by = list(dpm_stage1$cow), FUN = mean, na.rm = TRUE),4)
dpm_stage1$dpm1 <- ifelse(is.nan(dpm_stage1$dpm), 0, dpm_stage1$dpm)
dpm_stage1 <- select(dpm_stage1, cow, dpm1)
df <- left_join(issp16dfa, gov_resp1, by = "cow")
df <- left_join(df, gov_resp2, by = "cow")
df <- left_join(df, gov_resp3, by = "cow")
df <- left_join(df, betrack_av, by = "cow")
df <- left_join(df, dpm_stage1, by = "cow")
df <- left_join(df, dpm_stage2, by = "cow")
df <- left_join(df, dpm_stage3, by = "cow")
df <- left_join(df, gini_disp, by = "cow")
df <- left_join(df, gdp, by = "cow")
df <- left_join(df, socp, by = "cow")
## filter out Suriname
df <- df[-which(df$cow==115),]
m11 <- lm(chi1 ~ dpm1 + gov_author , data = df)
m12 <- lm(chi1 ~ dpm1 + gov_author + gini_disp, data = df)
m13 <- lm(chi1 ~ dpm1 + gov_author + soc_spend, data = df)
m14 <- lm(chi1 ~ dpm1 + gov_author + gdp, data = df)
m15 <- lm(chi1 ~ dpm1 + gov_author + gini_disp + soc_spend + gdp, data = df)
tab_model(m11, m12, m13, m14, m15, p.style = "stars", p.threshold = c(0.10, 0.05, 0.01), show.ci = F,  dv.labels = c("M11", "M12","M13", "M14","M15"), pred.labels = c("Intercept", "Deaths per Million", "Public Preferences", "Disposable Income Inequality", "Social Spending", "GDP (k$, per capita)"))
df$chi1_p <- predict.lm(m11, newdata = df)
df$gap1 <- round(df$chi1 - df$chi1_p,3)
df$gap1_cat <- as.factor(ifelse(df$gap1 > 0, 1, 0))
m21 <- lm(behave ~ dpm2 + chi2 , data = df)
m22 <- lm(behave  ~ dpm2 + chi2 + gap1, data = df)
m23 <- lm(behave  ~ dpm2 +  chi2 + gap1  + gini_disp, data = df)
m24 <- lm(behave ~ dpm2 +  chi2 + gap1  + soc_spend, data = df)
m25 <- lm(behave ~ dpm2 + chi2 + gap1 + gdp, data = df)
m26 <- lm(behave ~ dpm2 + chi2 + gap1 + gini_disp + soc_spend + gdp, data = df)
tab_model(m21, m22, m23, m24, m25, m26, p.style = "stars", p.threshold = c(0.10, 0.05, 0.01), show.ci = F,  dv.labels = c("M21", "M22","M23", "M24","M25", "M26"), pred.labels = c("Intercept", "Deaths per Million", "Current Gov. Intervention", "Discrepancy from Outbreak Stage",  "Disposable Income Inequality", "Social Spending", "GDP (k$, per capita)"))
dpm_stage1 <- filter(covid, covid$date >= "2020-03-01" & covid$date <= "2020-03-15")
dpm_stage1 <- round(aggregate(dpm_stage1[,-2], by = list(dpm_stage1$cow), FUN = mean, na.rm = TRUE),4)
dpm_stage1$dpm1 <- ifelse(is.nan(dpm_stage1$dpm), 0, dpm_stage1$dpm)
dpm_stage1 <- select(dpm_stage1, cow, dpm1)
gov_resp1 <- gov_resp %>%
mutate(
date = as.Date(as.character(Date), "%Y%m%d"),
chi = ContainmentHealthIndex/20,
cow = countrycode(CountryName, origin = "country.name", destination = "cown")
) %>%
filter(date >= "2020-03-01" & date <= "2020-03-15" & cow %in% issp16dfa$cow) %>%
select(CountryName, date, chi)
gov_resp1 <- aggregate(x = gov_resp1[,-2], by = list(gov_resp1$CountryName), FUN = mean)
gov_resp1 <- gov_resp1 %>%
mutate(
cname = Group.1,
cow = countrycode(cname, origin = "country.name", destination = "cown"),
chi1 = round(scale(chi),2),
chi1.2 = round(chi,2)
) %>%
select(cow, chi1, chi1.2) %>%
arrange(cow)
df <- left_join(issp16dfa, gov_resp1, by = "cow")
df <- left_join(df, gov_resp2, by = "cow")
df <- left_join(df, gov_resp3, by = "cow")
df <- left_join(df, betrack_av, by = "cow")
df <- left_join(df, dpm_stage1, by = "cow")
df <- left_join(df, dpm_stage2, by = "cow")
df <- left_join(df, dpm_stage3, by = "cow")
df <- left_join(df, gini_disp, by = "cow")
df <- left_join(df, gdp, by = "cow")
df <- left_join(df, socp, by = "cow")
## filter out Suriname
df <- df[-which(df$cow==115),]
m11 <- lm(chi1 ~ dpm1 + gov_author , data = df)
m12 <- lm(chi1 ~ dpm1 + gov_author + gini_disp, data = df)
m13 <- lm(chi1 ~ dpm1 + gov_author + soc_spend, data = df)
m14 <- lm(chi1 ~ dpm1 + gov_author + gdp, data = df)
m15 <- lm(chi1 ~ dpm1 + gov_author + gini_disp + soc_spend + gdp, data = df)
tab_model(m11, m12, m13, m14, m15, p.style = "stars", p.threshold = c(0.10, 0.05, 0.01), show.ci = F,  dv.labels = c("M11", "M12","M13", "M14","M15"), pred.labels = c("Intercept", "Deaths per Million", "Public Preferences", "Disposable Income Inequality", "Social Spending", "GDP (k$, per capita)"))
df$chi1_p <- predict.lm(m11, newdata = df)
df$gap1 <- round(df$chi1 - df$chi1_p,3)
df$gap1_cat <- as.factor(ifelse(df$gap1 > 0, 1, 0))
m21 <- lm(behave ~ dpm2 + chi2 , data = df)
m22 <- lm(behave  ~ dpm2 + chi2 + gap1, data = df)
m23 <- lm(behave  ~ dpm2 +  chi2 + gap1  + gini_disp, data = df)
m24 <- lm(behave ~ dpm2 +  chi2 + gap1  + soc_spend, data = df)
m25 <- lm(behave ~ dpm2 + chi2 + gap1 + gdp, data = df)
m26 <- lm(behave ~ dpm2 + chi2 + gap1 + gini_disp + soc_spend + gdp, data = df)
tab_model(m21, m22, m23, m24, m25, m26, p.style = "stars", p.threshold = c(0.10, 0.05, 0.01), show.ci = F,  dv.labels = c("M21", "M22","M23", "M24","M25", "M26"), pred.labels = c("Intercept", "Deaths per Million", "Current Gov. Intervention", "Discrepancy from Outbreak Stage",  "Disposable Income Inequality", "Social Spending", "GDP (k$, per capita)"))
m31 <- lm(behave ~ dpm2 + chi2 , data = df)
m32 <- lm(behave  ~ dpm2 + chi2 + gap1_cat, data = df)
m33 <- lm(behave  ~ dpm2 +  chi2 + gap1_cat  + gini_disp, data = df)
m34 <- lm(behave ~ dpm2 +  chi2 + gap1_cat  + soc_spend, data = df)
m35 <- lm(behave ~ dpm2 + chi2 + gap1_cat + gdp, data = df)
m36 <- lm(behave ~ dpm2 + chi2 + gap1_cat + gini_disp + soc_spend + gdp, data = df)
tab_model(m31, m32, m33, m34, m35, m36, p.style = "stars", p.threshold = c(0.10, 0.05, 0.01), show.ci = F,  dv.labels = c("M31", "M32","M33", "M34","M35", "M36"), pred.labels = c("Intercept", "Deaths per Million", "Current Gov. Intervention", "Positive Discrepancy from Outbreak Stage",  "Disposable Income Inequality", "Social Spending", "GDP (k$, per capita)"))
df$gap1_tri <- as.factor(
case_when(
df$gap1 > 0.05 ~ 1,
df$gap1 < -0.05 ~ -1,
TRUE ~ 0
)
)
m31 <- lm(behave ~ dpm2 + chi2 , data = df)
m32 <- lm(behave  ~ dpm2 + chi2 + gap1_tri, data = df)
m33 <- lm(behave  ~ dpm2 +  chi2 + gap1_tri  + gini_disp, data = df)
m34 <- lm(behave ~ dpm2 +  chi2 + gap1_tri  + soc_spend, data = df)
m35 <- lm(behave ~ dpm2 + chi2 + gap1_tri + gdp, data = df)
m36 <- lm(behave ~ dpm2 + chi2 + gap1_tri + gini_disp + soc_spend + gdp, data = df)
tab_model(m31, m32, m33, m34, m35, m36, p.style = "stars", p.threshold = c(0.10, 0.05, 0.01), show.ci = F,  dv.labels = c("M31", "M32","M33", "M34","M35", "M36"), pred.labels = c("Intercept", "Deaths per Million", "Current Gov. Intervention", "Positive Discrepancy from Outbreak Stage",  "Disposable Income Inequality", "Social Spending", "GDP (k$, per capita)"))
